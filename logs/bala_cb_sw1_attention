================================================================================
               CAN3TOK TRAINING - SEMANTIC LEARNING CONTROL
================================================================================
Job ID: 19327930
Node: gcn159
Start time: Sun Feb  8 12:26:17 CET 2026

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        CONFIGURATION SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ JOB INFORMATION:
   Job ID:            19327930
   Partition:         gpu_h100
   Node:              gcn159
   GPUs:              1
   CPUs:              9
   Memory:            64GB
   Time Limit:        12:00:00

ğŸ§  SEMANTIC LEARNING:
   Status:            âœ… ENABLED
   Mode:              ATTENTION

   Loss Weights:
      Segment (Î²):    1.0
      Instance (Î³):   0.0
      Temperature:    0.1
      Subsample:      10000 Gaussians

   Architecture Details:
      Approach:       Cross-attention semantic head
      Input:          [B, 40k, 3] positions Ã— [B, 512, 384] tokens
      Output:         [B, 40k, 32] semantic features
      Parameters:     ~158M (medium weight)
      Memory Usage:   ~30GB GPU
      Training Speed: âš¡âš¡ Medium
      Best For:       Spatial semantic relationships
      Notes:          Good for capturing scene context

   Loss Composition:
      Total = (Recon / 1.0) + (1e-4 Ã— KL) + Semantic
      Semantic = (1.0 Ã— Segment) + (0.0 Ã— Instance)

âš™ï¸  TRAINING HYPERPARAMETERS:
   Batch Size:        64
   Epochs:            100
   Learning Rate:     1e-4
   KL Weight:         1e-4
   Recon Scale:       1.0
   Eval Every:        10 epochs
   Failure Thresh:    150

ğŸ“Š DATASET:
   Training Scenes:   600
   Val Scenes:        50
   Sampling:          OPACITY
   Dataset:           SceneSplat-7K (ScanNet72 labels)
   Semantic Classes:  72 categories (38 main + 34 rare)

ğŸ“ˆ LOGGING:
   W&B:               âŒ Disabled
   Checkpoints:       Every 10 epochs
   Best Model:        Tracked by val L2 error
   Output Log:        logs/can3tok_19327930.out

ğŸ¯ EXPECTED PERFORMANCE:
   Initial L2:        ~19,000 (random)
   Target L2:         ~3,000-5,000 (converged)
   Failure if:        L2 > 150

   Semantic Loss:
      Initial:        ~4.28 (log(72), random features)
      Target:         ~0.5-1.5 (learned clusters)
      âš ï¸  Watch:       Should decrease steadily

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ Setting up environment...
   âœ“ Modules loaded
   âœ“ Conda environment: can3tok
   âœ“ Working directory: /home/yli11/scratch/Hafeez_thesis/Can3Tok


ğŸš€ Building training command...
Command:
python  gs_can3tok_2.py --batch_size 64 --num_epochs 100 --lr 1e-4 --kl_weight 1e-4 --eval_every 10 --failure_threshold 150 --recon_scale 1.0 --train_scenes 600 --val_scenes 50 --sampling_method opacity --semantic_mode attention --segment_loss_weight 1.0 --instance_loss_weight 0.0 --semantic_temperature 0.1 --semantic_subsample 10000 --sampling_strategy balanced

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          STARTING TRAINING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ— Weights & Biases disabled

======================================================================
ğŸš€ CAN3TOK TRAINING - IMPROVED VERSION
======================================================================
Configuration:
  Job ID: 19327930
  Semantic Mode (requested): attention
  Semantic Mode (effective): attention
  Semantic Enabled: True

  ğŸ§  SEMANTIC LEARNING: âœ… ENABLED
     Mode: attention
     Segment weight (Î²): 1.0
     Instance weight (Î³): 0.0
     Temperature (Ï„): 0.1
     Subsample: 10000

  Device: cuda:0
  Batch size: 64
  Epochs: 100
  Learning rate: 0.0001
  KL weight: 0.0001
  Save path: /home/yli11/scratch/Hafeez_thesis/Can3Tok/checkpoints/job_19327930_attention_beta1.0/
======================================================================

Loading model configuration...
âœ“ Loaded YAML config
âœ“ Overriding with command-line arguments...
   semantic_mode: attention

======================================================================
INSTANTIATING MODEL
======================================================================

======================================================================
ğŸš€ PERFORMANCE FIX APPLIED - ISSUE #1
[AlignedShapeLatentPerceiver] semantic_mode='attention'
======================================================================
[GaussianSemanticAttentionHead] Cross-Attention:
  Queries: [B, 40k, 3] Gaussian positions
  Keys/Values: [B, 256, 384] scene tokens
  Output: [B, 40k, 32]
  Parameters: 1.807M
âœ“ Initialized CROSS-ATTENTION semantic head ONLY
âœ“ Saved ~15GB memory by NOT loading other heads!
======================================================================

âœ“ Model instantiated successfully
======================================================================

âœ“ Model loaded successfully

Loading datasets...

======================================================================
TRAINING DATASET
======================================================================
  Limited to 600 scenes (out of 3888 available)
âœ“ Loaded 600 scenes from /home/yli11/scratch/datasets/gaussian_world/preprocessed/interior_gs/train_grid1.0cm_chunk8x8_stride6x6
âœ“ Sampling method: opacity
âœ“ Dataset type: ScanNet72 with 72 categories
âœ“ Missing categories in dataset: [13, 53, 61] (never appear)
âœ“ Expected InfoNCE loss with random features: log(72) â‰ˆ 4.2767
======================================================================
VALIDATION DATASET
======================================================================
  Limited to 50 scenes (out of 100 available)
âœ“ Loaded 50 scenes from /home/yli11/scratch/datasets/gaussian_world/preprocessed/interior_gs/val
âœ“ Sampling method: opacity
âœ“ Dataset type: ScanNet72 with 72 categories
âœ“ Missing categories in dataset: [13, 53, 61] (never appear)
âœ“ Expected InfoNCE loss with random features: log(72) â‰ˆ 4.2767
======================================================================
DATASET SUMMARY
======================================================================
âœ“ Training: 600 scenes, 10 batches
âœ“ Validation: 50 scenes, 1 batches
âœ“ Sampling method: opacity
======================================================================

======================================================================
STARTING TRAINING
ğŸ§  SEMANTIC LEARNING ENABLED (mode: attention)
======================================================================

Epoch 0/100 | Loss: 241.62 | Recon: 236.84 | KL: 6432.78 | Semantic: 4.1295

======================================================================
VALIDATION (Epoch 0)
======================================================================
  L2 Error: 201.06 Â± 75.56
  Failure Rate: 64.00%
  âœ“ New best model! (L2: 201.06)
======================================================================

Epoch 1/100 | Loss: 231.33 | Recon: 227.11 | KL: 1230.20 | Semantic: 4.0956
Epoch 2/100 | Loss: 214.07 | Recon: 209.95 | KL: 792.54 | Semantic: 4.0436
Epoch 3/100 | Loss: 188.58 | Recon: 184.38 | KL: 564.30 | Semantic: 4.1342
Epoch 4/100 | Loss: 231.04 | Recon: 226.95 | KL: 450.11 | Semantic: 4.0527
Epoch 5/100 | Loss: 231.25 | Recon: 227.09 | KL: 356.43 | Semantic: 4.1289
Epoch 6/100 | Loss: 231.65 | Recon: 227.51 | KL: 299.86 | Semantic: 4.1093
Epoch 7/100 | Loss: 220.77 | Recon: 216.67 | KL: 257.45 | Semantic: 4.0674
Epoch 8/100 | Loss: 218.21 | Recon: 214.18 | KL: 226.69 | Semantic: 4.0161
Epoch 9/100 | Loss: 172.01 | Recon: 167.93 | KL: 203.64 | Semantic: 4.0587
Epoch 10/100 | Loss: 257.18 | Recon: 253.12 | KL: 184.16 | Semantic: 4.0419

======================================================================
VALIDATION (Epoch 10)
======================================================================
  L2 Error: 193.70 Â± 71.60
  Failure Rate: 54.00%
  âœ“ New best model! (L2: 193.70)
======================================================================

âœ“ Checkpoint saved: epoch_10.pth
Epoch 11/100 | Loss: 267.78 | Recon: 263.73 | KL: 167.58 | Semantic: 4.0267
Epoch 12/100 | Loss: 222.44 | Recon: 218.41 | KL: 171.91 | Semantic: 4.0116
Epoch 13/100 | Loss: 213.19 | Recon: 209.24 | KL: 164.93 | Semantic: 3.9403
Epoch 14/100 | Loss: 200.80 | Recon: 196.84 | KL: 210.54 | Semantic: 3.9342
Epoch 15/100 | Loss: 208.30 | Recon: 204.26 | KL: 640.92 | Semantic: 3.9744
Epoch 16/100 | Loss: 160.70 | Recon: 156.56 | KL: 962.30 | Semantic: 4.0372
Epoch 17/100 | Loss: 257.16 | Recon: 253.23 | KL: 465.68 | Semantic: 3.8805
Epoch 18/100 | Loss: 226.25 | Recon: 222.28 | KL: 948.58 | Semantic: 3.8729
Epoch 19/100 | Loss: 241.04 | Recon: 237.21 | KL: 497.86 | Semantic: 3.7758
Epoch 20/100 | Loss: 218.92 | Recon: 215.14 | KL: 291.11 | Semantic: 3.7549

======================================================================
VALIDATION (Epoch 20)
======================================================================
  L2 Error: 193.29 Â± 70.85
  Failure Rate: 54.00%
  âœ“ New best model! (L2: 193.29)
======================================================================

âœ“ Checkpoint saved: epoch_20.pth
Epoch 21/100 | Loss: 173.78 | Recon: 169.98 | KL: 158.20 | Semantic: 3.7879
Epoch 22/100 | Loss: 182.82 | Recon: 179.02 | KL: 271.90 | Semantic: 3.7749
Epoch 23/100 | Loss: 222.75 | Recon: 218.94 | KL: 583.70 | Semantic: 3.7517
Epoch 24/100 | Loss: 173.01 | Recon: 169.17 | KL: 703.69 | Semantic: 3.7676
Epoch 25/100 | Loss: 202.56 | Recon: 198.78 | KL: 656.04 | Semantic: 3.7140
Epoch 26/100 | Loss: 199.32 | Recon: 195.65 | KL: 404.72 | Semantic: 3.6244
Epoch 27/100 | Loss: 228.38 | Recon: 224.62 | KL: 403.32 | Semantic: 3.7207
Epoch 28/100 | Loss: 268.84 | Recon: 265.05 | KL: 379.99 | Semantic: 3.7472
Epoch 29/100 | Loss: 202.05 | Recon: 198.27 | KL: 458.40 | Semantic: 3.7328
Epoch 30/100 | Loss: 193.00 | Recon: 189.21 | KL: 258.12 | Semantic: 3.7615

======================================================================
VALIDATION (Epoch 30)
======================================================================
  L2 Error: 192.91 Â± 70.56
  Failure Rate: 54.00%
  âœ“ New best model! (L2: 192.91)
======================================================================

âœ“ Checkpoint saved: epoch_30.pth
Epoch 31/100 | Loss: 236.25 | Recon: 232.50 | KL: 359.18 | Semantic: 3.7091
Epoch 32/100 | Loss: 272.53 | Recon: 268.82 | KL: 494.67 | Semantic: 3.6570
Epoch 33/100 | Loss: 187.60 | Recon: 183.86 | KL: 520.09 | Semantic: 3.6828
Epoch 34/100 | Loss: 222.74 | Recon: 219.06 | KL: 629.49 | Semantic: 3.6130
Epoch 35/100 | Loss: 224.64 | Recon: 220.93 | KL: 265.25 | Semantic: 3.6805
Epoch 36/100 | Loss: 210.14 | Recon: 206.42 | KL: 581.16 | Semantic: 3.6668
Epoch 37/100 | Loss: 192.15 | Recon: 188.33 | KL: 430.61 | Semantic: 3.7767
Epoch 38/100 | Loss: 268.32 | Recon: 264.67 | KL: 308.39 | Semantic: 3.6240
Epoch 39/100 | Loss: 231.35 | Recon: 227.53 | KL: 710.67 | Semantic: 3.7410
Epoch 40/100 | Loss: 188.48 | Recon: 184.71 | KL: 395.80 | Semantic: 3.7314

======================================================================
VALIDATION (Epoch 40)
======================================================================
  L2 Error: 192.68 Â± 70.37
  Failure Rate: 54.00%
  âœ“ New best model! (L2: 192.68)
======================================================================

âœ“ Checkpoint saved: epoch_40.pth
Epoch 41/100 | Loss: 203.00 | Recon: 199.17 | KL: 718.44 | Semantic: 3.7664
Epoch 42/100 | Loss: 203.19 | Recon: 199.52 | KL: 245.48 | Semantic: 3.6417
Epoch 43/100 | Loss: 204.73 | Recon: 200.97 | KL: 496.45 | Semantic: 3.7117
Epoch 44/100 | Loss: 217.99 | Recon: 214.22 | KL: 641.06 | Semantic: 3.7095
Epoch 45/100 | Loss: 243.21 | Recon: 239.41 | KL: 292.39 | Semantic: 3.7763
Epoch 46/100 | Loss: 235.42 | Recon: 231.78 | KL: 289.33 | Semantic: 3.6135
Epoch 47/100 | Loss: 253.73 | Recon: 249.98 | KL: 713.04 | Semantic: 3.6823
Epoch 48/100 | Loss: 183.87 | Recon: 180.16 | KL: 590.50 | Semantic: 3.6520
Epoch 49/100 | Loss: 191.58 | Recon: 187.75 | KL: 230.59 | Semantic: 3.8006
Epoch 50/100 | Loss: 249.69 | Recon: 245.96 | KL: 544.00 | Semantic: 3.6772

======================================================================
VALIDATION (Epoch 50)
======================================================================
  L2 Error: 192.84 Â± 70.56
  Failure Rate: 54.00%
======================================================================

âœ“ Checkpoint saved: epoch_50.pth
Epoch 51/100 | Loss: 216.02 | Recon: 212.25 | KL: 888.13 | Semantic: 3.6722
Epoch 52/100 | Loss: 156.09 | Recon: 152.32 | KL: 288.08 | Semantic: 3.7374
Epoch 53/100 | Loss: 256.46 | Recon: 252.70 | KL: 540.84 | Semantic: 3.7087
Epoch 54/100 | Loss: 214.23 | Recon: 210.46 | KL: 788.64 | Semantic: 3.6906
Epoch 55/100 | Loss: 202.32 | Recon: 198.59 | KL: 428.28 | Semantic: 3.6885
Epoch 56/100 | Loss: 212.22 | Recon: 208.52 | KL: 550.01 | Semantic: 3.6410
Epoch 57/100 | Loss: 210.03 | Recon: 206.29 | KL: 432.50 | Semantic: 3.6939
Epoch 58/100 | Loss: 194.81 | Recon: 191.14 | KL: 210.44 | Semantic: 3.6517
Epoch 59/100 | Loss: 266.21 | Recon: 262.48 | KL: 268.86 | Semantic: 3.7003
Epoch 60/100 | Loss: 179.01 | Recon: 175.26 | KL: 429.08 | Semantic: 3.7111

======================================================================
VALIDATION (Epoch 60)
======================================================================
  L2 Error: 192.58 Â± 70.38
  Failure Rate: 54.00%
  âœ“ New best model! (L2: 192.58)
======================================================================

âœ“ Checkpoint saved: epoch_60.pth
Epoch 61/100 | Loss: 187.37 | Recon: 183.60 | KL: 1076.63 | Semantic: 3.6555
Epoch 62/100 | Loss: 195.40 | Recon: 191.70 | KL: 216.43 | Semantic: 3.6793
Epoch 63/100 | Loss: 192.63 | Recon: 188.85 | KL: 879.18 | Semantic: 3.6949
Epoch 64/100 | Loss: 200.71 | Recon: 197.07 | KL: 304.73 | Semantic: 3.6104
Epoch 65/100 | Loss: 228.26 | Recon: 224.57 | KL: 305.77 | Semantic: 3.6595
Epoch 66/100 | Loss: 248.95 | Recon: 245.39 | KL: 332.95 | Semantic: 3.5222
Epoch 67/100 | Loss: 200.19 | Recon: 196.51 | KL: 368.06 | Semantic: 3.6453
Epoch 68/100 | Loss: 186.68 | Recon: 182.96 | KL: 684.50 | Semantic: 3.6481
Epoch 69/100 | Loss: 206.83 | Recon: 203.19 | KL: 216.70 | Semantic: 3.6158
Epoch 70/100 | Loss: 194.42 | Recon: 190.77 | KL: 496.22 | Semantic: 3.6041

======================================================================
VALIDATION (Epoch 70)
======================================================================
  L2 Error: 192.65 Â± 70.38
  Failure Rate: 54.00%
======================================================================

âœ“ Checkpoint saved: epoch_70.pth
Epoch 71/100 | Loss: 219.37 | Recon: 215.62 | KL: 461.94 | Semantic: 3.6988
Epoch 72/100 | Loss: 178.12 | Recon: 174.48 | KL: 362.45 | Semantic: 3.6046
Epoch 73/100 | Loss: 163.00 | Recon: 159.18 | KL: 1333.05 | Semantic: 3.6816
Epoch 74/100 | Loss: 240.48 | Recon: 236.80 | KL: 211.61 | Semantic: 3.6502
Epoch 75/100 | Loss: 195.25 | Recon: 191.48 | KL: 1204.87 | Semantic: 3.6542
Epoch 76/100 | Loss: 231.69 | Recon: 228.03 | KL: 338.79 | Semantic: 3.6209
Epoch 77/100 | Loss: 227.29 | Recon: 223.70 | KL: 244.20 | Semantic: 3.5681
Epoch 78/100 | Loss: 183.64 | Recon: 179.89 | KL: 544.02 | Semantic: 3.6968
Epoch 79/100 | Loss: 198.33 | Recon: 194.61 | KL: 388.11 | Semantic: 3.6865
Epoch 80/100 | Loss: 229.62 | Recon: 225.75 | KL: 648.79 | Semantic: 3.8063

======================================================================
VALIDATION (Epoch 80)
======================================================================
  L2 Error: 192.89 Â± 70.42
  Failure Rate: 54.00%
======================================================================

âœ“ Checkpoint saved: epoch_80.pth
Epoch 81/100 | Loss: 220.53 | Recon: 216.85 | KL: 292.61 | Semantic: 3.6452
Epoch 82/100 | Loss: 166.78 | Recon: 163.08 | KL: 190.92 | Semantic: 3.6764
Epoch 83/100 | Loss: 242.02 | Recon: 238.44 | KL: 88.30 | Semantic: 3.5705
Epoch 84/100 | Loss: 248.11 | Recon: 244.48 | KL: 271.69 | Semantic: 3.6039
Epoch 85/100 | Loss: 215.97 | Recon: 212.31 | KL: 149.55 | Semantic: 3.6442
Epoch 86/100 | Loss: 243.40 | Recon: 239.78 | KL: 94.39 | Semantic: 3.6041
Epoch 87/100 | Loss: 228.09 | Recon: 224.47 | KL: 82.07 | Semantic: 3.6171
Epoch 88/100 | Loss: 187.12 | Recon: 183.42 | KL: 477.15 | Semantic: 3.6477
Epoch 89/100 | Loss: 207.72 | Recon: 204.11 | KL: 146.52 | Semantic: 3.5912
Epoch 90/100 | Loss: 212.99 | Recon: 209.31 | KL: 224.68 | Semantic: 3.6545

======================================================================
VALIDATION (Epoch 90)
======================================================================
  L2 Error: 193.16 Â± 70.46
  Failure Rate: 54.00%
======================================================================

âœ“ Checkpoint saved: epoch_90.pth
Epoch 91/100 | Loss: 214.54 | Recon: 210.85 | KL: 217.27 | Semantic: 3.6724
Epoch 92/100 | Loss: 195.41 | Recon: 191.81 | KL: 187.95 | Semantic: 3.5898
Epoch 93/100 | Loss: 178.41 | Recon: 174.75 | KL: 151.94 | Semantic: 3.6386
Epoch 94/100 | Loss: 209.60 | Recon: 205.95 | KL: 84.62 | Semantic: 3.6484
Epoch 95/100 | Loss: 242.89 | Recon: 239.24 | KL: 106.49 | Semantic: 3.6483
Epoch 96/100 | Loss: 152.38 | Recon: 148.74 | KL: 73.51 | Semantic: 3.6356
Epoch 97/100 | Loss: 213.95 | Recon: 210.31 | KL: 129.42 | Semantic: 3.6280
Epoch 98/100 | Loss: 213.69 | Recon: 210.08 | KL: 94.93 | Semantic: 3.6007
Epoch 99/100 | Loss: 240.16 | Recon: 236.56 | KL: 144.44 | Semantic: 3.5876

======================================================================
VALIDATION (Epoch 99)
======================================================================
  L2 Error: 192.82 Â± 70.58
  Failure Rate: 54.00%
======================================================================


======================================================================
TRAINING COMPLETE
======================================================================

Final Results:
  Final L2: 192.86
  Best L2: 192.58 (epoch 60)
âœ“ Saved: /home/yli11/scratch/Hafeez_thesis/Can3Tok/checkpoints/job_19327930_attention_beta1.0/final.pth
======================================================================

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          TRAINING COMPLETE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Exit code:     0
Duration:      227 minutes
End time:      Sun Feb  8 16:13:36 CET 2026

âœ… Training completed successfully!

Next steps:
   1. Check logs:           cat logs/can3tok_19327930.out
   2. Find checkpoints:     ls checkpoints/job_19327930_*/
   3. Load best model:      checkpoints/job_19327930_*/best_model.pth
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
